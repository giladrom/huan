<ion-header no-border [ngClass]="fade-in">

  <ion-navbar color="primary">
    <button ion-button menuToggle>
      <ion-icon name="menu" large></ion-icon>
    </button>

    <ion-title>
      My Pets
    </ion-title>
    <ion-buttons end>
      <button ion-button icon-only (click)="addTag()">
        <ion-icon name='add' large></ion-icon>
      </button>
    </ion-buttons>

  </ion-navbar>

  <ion-toolbar *ngIf="!bluetooth">
    <div id="header-error">WARNING: Bluetooth Disabled. Unable to monitor tags.</div>
  </ion-toolbar>

</ion-header>

<ion-content fullscreen no-padding no-bounce>
  <div #taglist id="taglist">
    <!-- <ion-list class="taglist" no-lines> -->
    <div *ngFor="let tag of (tag$ | async)" id="list-item{{tag.tagId}}" class="list-item" no-lines no-padding>
      <div class="title-img">
        <img-loader [src]="tag.img" useImg></img-loader>
      </div>
      <div class="card-title">
        <ion-icon *ngIf="getTagWarnings(tag)" id="alert-icon" name="alert"></ion-icon>
        {{ tag.name }}
      </div>
      <div [ngClass]="getSubtitleCssClass(tag.tagId)" text-wrap>
        {{ getSubtitleText(tag.tagId) }}
      </div>

      <div class="battery-icon">
        <img-loader [src]="getBatteryIcon(tag.hw.batt)" useImg></img-loader>
      </div>

      <ion-icon name="ios-map-outline" class="map-button" (click)="showOnMap(tag.tagId)"></ion-icon>
      <ion-icon name="ios-create-outline" class="edit-button" (click)="editTag(tag.tagId)"></ion-icon>

      <div class="expand-icon">
        <ion-icon id="expand-arrow{{tag.tagId}}" class="fade-in" name='arrow-down' (click)="expandCollapseItem(tag.tagId)"></ion-icon>
      </div>
      <div class="collapse-icon">
        <ion-icon id="collapse-arrow{{tag.tagId}}" class="fade-in" style="display: none;" name='arrow-up' (click)="expandCollapseItem(tag.tagId) "></ion-icon>
      </div>
      <div id="details{{tag.tagId}}" class="details" style="height: 0px;">
        <ion-list no-lines no-padding>
          <ion-item no-lines class="details">
            <ion-icon name="pin" item-start></ion-icon>
            Near {{ getTownName(tag.tagId) }}
            <button ion-button [ngClass]="getCssClass(tag.tagId)" (click)="markAsFunc(tag.tagId)" item-end>{{ markAsText(tag.tagId) }}</button>
          </ion-item>
          <ion-item no-lines class="details">
            <ion-icon name="list" item-start></ion-icon>
            {{ tag.color }} // {{ tag.breed }} // {{ tag.size }}
          </ion-item>
        </ion-list>
      </div>
    </div>

    <ion-item *ngIf="(tag$ | async)?.length == 0" text-wrap id="page-main-title" no-lines>
      Your pets will appear here after you add them.
    </ion-item>
    <!-- </ion-list> -->
  </div>
</ion-content>