<ion-header no-border [ngClass]="fade-in">

  <ion-navbar color="primary">
    <button ion-button menuToggle>
      <ion-icon name="menu" large></ion-icon>
    </button>

    <ion-title>
      Home
    </ion-title>

    <ion-buttons end>
      <button ion-button icon-only (click)="addTag()">
        <ion-icon name='add' large></ion-icon>
      </button>
    </ion-buttons>

  </ion-navbar>
  <ion-toolbar>
    <ion-segment [(ngModel)]="viewMode" (ionChange)="updateView()">
      <ion-segment-button value="map">
        <ion-icon name="ios-map-outline"></ion-icon>
      </ion-segment-button>
      <ion-segment-button value="list">
        <ion-icon name="list"></ion-icon>
      </ion-segment-button>
    </ion-segment>
  </ion-toolbar>
</ion-header>

<ion-content fullscreen no-padding no-bounce [ngClass]="fade-in">
  <!-- Main Map Display -->
  <div #mainmap id="mainmap"></div>
  <div #navbutton id="navbutton">
    <button ion-button id="action-button" (click)="showMyPets()">Show my Pets</button>
  </div>

  <!-- Tag List View -->
  <div #taglist id="taglist">
    <ion-list class="taglist" no-lines>


      <div *ngFor="let tag of (tag$ | async)" id="list-item{{tag.tagId}}" class="list-item" no-lines no-padding>
        <div class="pickgradient">
          <img-loader [src]="tag.img " class="title-img " useImg></img-loader>
        </div>


        <div class="card-title">
          {{ tag.name }}
        </div>
        <div class="card-subtitle" text-wrap>Last seen {{ lastSeen(tag.lastseen) }}</div>
        <div *ngIf="tag.lost " class="marked-lost " text-wrap>Marked as Lost {{ lastSeen(tag.markedlost) }}</div>
        <ion-icon name="ios-map-outline" class="map-button" (click)="showOnMap(tag.tagId)"></ion-icon>
        <ion-icon name="ios-create-outline" class="edit-button" (click)="editTag(tag.tagId)"></ion-icon>

        <div class="expand-icon">
          <ion-icon id="expand-arrow{{tag.tagId}}" class="fade-in" name='arrow-down' (click)="expandCollapseItem(tag.tagId)"></ion-icon>

        </div>
        <div class="collapse-icon">
          <ion-icon id="collapse-arrow{{tag.tagId}}" class="fade-in" style="display: none;" name='arrow-up' (click)="expandCollapseItem(tag.tagId) "></ion-icon>
        </div>
        <div id="details{{tag.tagId}}" class="details" style="height: 0px;">
          <ion-list no-lines no-padding>
            <ion-item *ngIf="getTownName(tag.tagId).length > 0" no-lines class="details">
              <ion-icon name="pin" item-start></ion-icon>
              Near {{ getTownName(tag.tagId) }}
            </ion-item>
            <ion-item no-lines class="details">
              <ion-icon name="list" item-start></ion-icon>
              {{ tag.color }} // {{ tag.breed }} // {{ tag.size }}
            </ion-item>
          </ion-list>
          <!-- <button ion-button class="list-button" (click)="editTag(tag.tagId)">
            Edit
          </button> -->


        </div>
      </div>

      <!-- </ion-card> -->
      <!-- </ion-item> -->
      <ion-item *ngIf="(tag$ | async)?.length == 0" text-wrap id="page-main-title" no-lines>
        Your pets will appear here after you add them.
      </ion-item>
    </ion-list>
  </div>
</ion-content>